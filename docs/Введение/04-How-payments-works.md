# Как работает платёж - начало

### Введение

Пользователь может совершить платёж по ссылке типа `drom.one/app/test`, но это будет неинтересно, ибо это просто пожертвование. Намного интереснее, когда ты можешь идентифицировать платёж и обработать его.

### Идентификация платежа

Чтобы ты мог знать что это за платёж - присвой ему номер или уникальный идентификатор. Например, у меня это будет строчка `88273-D`. Также, чтобы пользователь точно знал за что платит - нужно описание. В моём случае это `Заказ 88273-D`.

Используем query параметры `uid` и `text` соответственно. В итоге получаем `drom.one/app/test?uid=88273-D&text=Заказ 88273-D`.

Если необходимо указать точную сумму платежу - после название приложения дописываем `/СУММА`, например `drom.one/app/test/8` (запрос 8 АР). В таком случае ссылка будет выглядеть уже как `drom.one/app/test/8?uid=88273-D&text=Заказ 88273-D`

### Подпись

Пользователь может очень легко подменить uid, text, или сумму заказа, что может привести к поломке вашего приложения или к внеплановому безвозмездному переводу пользователем (чему он может крайне удивиться), который ваше приложение просто не будет обрабатывать в силу неверных данных.

Чтобы избежать такого, необхдимо поставить галочку на ["Подпись товара"](03-Fields-meaning.md) в [настройках приложения](02-Many-fields.md). А также добавить ещё один query параметр - `sign`. Чтобы его создать, нужно хэшировать в md5 строку `{uid}.{text}.{sum}.{app_id}.{app_secret}`, где app_id и app_secret - поля [раздела хакера](03-Fields-meaning.md) (фигурные скобки писать ненужно).

Например, в нашем случае шифруем строку `88273-D.Заказ 88273-D.8.1a2b3c4d5e6f7a8b9c0d1e2f.J-snWrj2kJ8Ba_we` в md5 и получим `3463fc536670d2e8d7899d628188c82b`. То есть `3463fc536670d2e8d7899d628188c82b` будет являться подписью конкретно данного заказа.

Добавляем как query параметр и получаем `drom.one/app/test/8?uid=88273-D&text=Заказ 88273-D&sign=3463fc536670d2e8d7899d628188c82b`. Эту ссылку мы отправляем пользователю (или редиректим его по этой ссылке), и он оплачивает товар.

### А дальше?

Теперь у нас есть два варианта узнать, что пользователь совершил успешный платёж:

- [Callback API](05-How-payments-works-callback.md)
- [Apps API](06-How-payments-works-apps.md)
